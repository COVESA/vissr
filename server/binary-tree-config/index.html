<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.103.1" />
    <meta name="description" content="">


    <link rel="shortcut icon" href="/vissr/images/fav.png" type="image/x-icon" />

    <title>VISSR binary tree configuration :: COVESA VISSv2 Reference Implementation (vissr)</title>

    
    <link href="/vissr/css/nucleus.css?1739175074" rel="stylesheet">
    <link href="/vissr/css/fontawesome-all.min.css?1739175074" rel="stylesheet">
    <link href="/vissr/css/hybrid.css?1739175074" rel="stylesheet">
    <link href="/vissr/css/featherlight.min.css?1739175074" rel="stylesheet">
    <link href="/vissr/css/perfect-scrollbar.min.css?1739175074" rel="stylesheet">
    <link href="/vissr/css/auto-complete.css?1739175074" rel="stylesheet">
    <link href="/vissr/css/atom-one-dark-reasonable.css?1739175074" rel="stylesheet">
    <link href="/vissr/css/theme.css?1739175074" rel="stylesheet">
    <link href="/vissr/css/tabs.css?1739175074" rel="stylesheet">
    <link href="/vissr/css/hugo-theme.css?1739175074" rel="stylesheet">
    
    <link href="/vissr/css/theme-blue.css?1739175074" rel="stylesheet">
    
    

    <script src="/vissr/js/jquery-3.3.1.min.js?1739175074"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/vissr/server/binary-tree-config/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://covesa.github.io/vissr/">
  <img src="/vissr/images/vissv2.png">
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/vissr/js/lunr.min.js?1739175074"></script>
<script type="text/javascript" src="/vissr/js/auto-complete.js?1739175074"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/covesa.github.io\/vissr\/";
    
</script>
<script type="text/javascript" src="/vissr/js/search.js?1739175074"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/vissr/build-system/" title="VISSR Build System" class="dd-item
        
        
        
        ">
      <a href="/vissr/build-system/">
          VISSR Build System
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/vissr/build-system/hello-world/" title="VISSR Hello World example" class="dd-item
        
        
        
        ">
      <a href="/vissr/build-system/hello-world/">
          VISSR Hello World example
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vissr/client/" title="VISSR Clients" class="dd-item
        
        
        
        ">
      <a href="/vissr/client/">
          VISSR Clients
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vissr/datastore/" title="VISSR Data Storage" class="dd-item
        
        
        
        ">
      <a href="/vissr/datastore/">
          VISSR Data Storage
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/vissr/datastore/apache-iotdb/" title="VISSR Apache IoTDB" class="dd-item
        
        
        
        ">
      <a href="/vissr/datastore/apache-iotdb/">
          VISSR Apache IoTDB
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vissr/datastore/memcached/" title="VISSR Memcached" class="dd-item
        
        
        
        ">
      <a href="/vissr/datastore/memcached/">
          VISSR Memcached
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vissr/datastore/redis/" title="VISSR Redis" class="dd-item
        
        
        
        ">
      <a href="/vissr/datastore/redis/">
          VISSR Redis
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vissr/datastore/sqlite/" title="VISSR SQLite" class="dd-item
        
        
        
        ">
      <a href="/vissr/datastore/sqlite/">
          VISSR SQLite
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vissr/docker-step-by-step/" title="VISSR Docker" class="dd-item
        
        
        
        ">
      <a href="/vissr/docker-step-by-step/">
          VISSR Docker
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vissr/feeder/" title="VISSR Feeders" class="dd-item
        
        
        
        ">
      <a href="/vissr/feeder/">
          VISSR Feeders
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vissr/peripheral-components/" title="VISSR peripheral components" class="dd-item
        
        
        
        ">
      <a href="/vissr/peripheral-components/">
          VISSR peripheral components
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vissr/pocs/" title="VISSR POCs" class="dd-item
        
        
        
        ">
      <a href="/vissr/pocs/">
          VISSR POCs
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/vissr/pocs/poc2/" title="Next POC..." class="dd-item
        
        
        
        ">
      <a href="/vissr/pocs/poc2/">
          Next POC...
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vissr/pocs/poc1/" title="Vehicle.Speed subscription example" class="dd-item
        
        
        
        ">
      <a href="/vissr/pocs/poc1/">
          Vehicle.Speed subscription example
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vissr/server/" title="VISSR Server" class="dd-item
        parent
        
        
        ">
      <a href="/vissr/server/">
          VISSR Server
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/vissr/server/access-control-servers/" title="VISSR Access Control Servers" class="dd-item
        
        
        
        ">
      <a href="/vissr/server/access-control-servers/">
          VISSR Access Control Servers
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vissr/server/binary-tree-config/" title="VISSR binary tree configuration" class="dd-item
        
        active
        
        ">
      <a href="/vissr/server/binary-tree-config/">
          VISSR binary tree configuration
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vissr/tools/" title="VISSR Tools" class="dd-item
        
        
        
        ">
      <a href="/vissr/tools/">
          VISSR Tools
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vissr/xtra/" title="VISSR Xtra Information" class="dd-item
        
        
        
        ">
      <a href="/vissr/xtra/">
          VISSR Xtra Information
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/covesa/vissr"><i class='fab fa-github'></i> Github repo</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/covesa/vissr/edit/master/tutorial/content/server/binary-tree-config/_index.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/vissr/'>COVESA Vehicle Information Service Specification version 3 Reference Implementation Tutorial</a> > <a href='/vissr/server/'>VISSR Server</a> > VISSR binary tree configuration
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#using-the-vss-project-to-generate-the-binary-file">Using the VSS project to generate the binary file</a></li>
    <li><a href="#using-the-cvis-project-to-generate-the-binary-file">Using the CVIS project to generate the binary file</a></li>
    <li><a href="#tagging-the-tree-for-access-control-and-consent-management">Tagging the tree for access control and consent management</a></li>
    <li><a href="#using-a-modified-make-file">Using a modified make file</a></li>
    <li><a href="#inserting-validate-tags">Inserting &lsquo;validate&rsquo; tags</a></li>
    <li><a href="#using-the-struct-datatype">Using the struct datatype</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              VISSR binary tree configuration
            </h1>
          

        



	<h2 id="using-the-vss-project-to-generate-the-binary-file">Using the VSS project to generate the binary file</h2>
<p>This requires that the <a href="https://github.com/COVESA/vehicle_signal_specification">VSS</a> repo is cloned and configured, for th latter see instructions on the repo.
To generate the binary file the make file in the root directory of the repo is used,
which requires that a Python virtual environment is configured before it is used for the first time.
This is done by entering the VSS root directory, then issuing a command to configure the environment,
and then activating it, installing the vss-tools, and deactivate it.</p>
<pre tabindex="0"><code>$ cd vehicle_signal_specification
$ python3 -m venv ~/.venv
$ source ~/.venv/bin/activate
(.venv)$ pip install --pre vss-tools
(.venv)$ deactivate
</code></pre><p>The above is only needed to be done once.
It might be necessary to install both python and pip if that is not already installed on the computer, see instructions in the repo documentation.
If the exporter complains when used to make the binary file also after following the instructions above, then adding the command</p>
<pre tabindex="0"><code>(.venv)$ pip install -e .
</code></pre><p>may fix it. If problems prevail it is probably necessary to create an issue at the VSS repo.</p>
<p>To then generate the VSS tree binary file the environment is activated, the make file is called to generate the binary file,
and then the environment can be deactivated.</p>
<pre tabindex="0"><code>$ source ~/.venv/bin/activate
(.venv)$ make binary
(.venv)$ deactivate
</code></pre><p>This generates a file with a name like &lsquo;vss.binary&rsquo;,
which then needs to be possibly renamed to a more descriptive name and then copied to the vissr/server/vissv2server/forest directory.
It must also be added to the viss.him file in the same directory for the server to include it at startup.</p>
<h2 id="using-the-cvis-project-to-generate-the-binary-file">Using the CVIS project to generate the binary file</h2>
<p>Another alternative for generating the binary file is to use the HIM configurator tool in the
<a href="https://github.com/COVESA/commercial-vehicle-information-specifications">Commercial Vehicle Information Specifications</a> repo.
The CVIS project is aiming at creating signal trees tailored to the needs of other vehicle types than the passenger cars that the VSS tree is focusing on.
Development is ongoing for the vehicle types Truck, Trailer, and Bus, but the project is open for development initiatives for other vehicle types.
Following the patterns and rules described on the repo it is reasonably straight forward to create your own tree on your local computer.</p>
<p>The generation of a binary tree from the vspec files is here done by using the HIM configurator tool.
It uses the VSS-tools exporters for the final step of generating the files,
providing extended tree configuration options, see the <a href="https://covesa.github.io/commercial-vehicle-information-specifications/">CVIS</a> documentation.
There it is also described how the same Python virtual environment as is used in the VSS alternative is configured (if not already done so in a VSS context)
and activated before using the HIM configurator.
ust as in the oher alternative the binary file needs to be copied to the vissr/server/vissv2server/forest directory,
and the viss.him file edited to include it.</p>
<h2 id="tagging-the-tree-for-access-control-and-consent-management">Tagging the tree for access control and consent management</h2>
<p>If you want to configure the tree to include access control, access control tags as described in the
<a href="https://raw.githack.com/covesa/vehicle-information-service-specification/main/spec/VISSv2_Core.html#access-control-selection">VISSv2 - Access Control Selection chapter</a> needs to be added to appropriate tree nodes.
This can either be done by editing vspec files directly (example below), or using the <a href="https://github.com/covesa/vss-tools">VSS-Tools</a> overlay mechanism.</p>
<p>Adding read-write access control and consent to the entire VSS tree can be done by modifying the root node in the spec/VehicleSignalSpecification.vspec file as shown below.
If consent should not be included then the commented line should be used instead.</p>
<pre tabindex="0"><code>Vehicle:
  type: branch
  validate: read-write+consent
#  validate: read-write
  description: High-level vehicle data.
</code></pre><p>The above validate statement is inherited by all of the descendants of the node.
It can be applied to any node in the tree to allow for some nodes to not be access controlled while others will be access controlled.
Changing read-write to write-only leads to that the server will allow reading of the data without a token,
but requiring a valid token for write requests to the data.</p>
<p>If the HIM configurator in the CVIS project is used to generate the binary tree that has been tagged as described a binary tree with the tagging data will be generated.
In the case that it is the alternative using the VSS support that is used then it is necessary to also manually edit the make file to add &lsquo;-e validate&rsquo;
in the calls to the exporters. This should be added just before the output file name in the command, c. f. how it is added in the
<a href="https://covesa.github.io/vehicle_signal_specification/rule_set/overlay/index.html">overlay example</a>.</p>
<p>The AT server uses the purposelist.json file to validate that a client request to access controlled data is permitted by the access token included in the request.
It therefore necessary to ensure that this file contains purpose(s) that includes the data that is access controlled tagged in the tree.</p>
<h2 id="using-a-modified-make-file">Using a modified make file</h2>
<p>The make file in the <a href="https://github.com/COVESA/vehicle_signal_specification">VSS</a> repo does not provide
CLI support for inserting validate tags or using struct datatypes that refer to a separate Type definition tree,
which leads to that the make file must be manually edited.
To avoid having to enter into such daring endeavours a modified make file can be found in the resource directory.
If this file replaces the existing VSS make file then it can be used as explained below when using the VSS as decribed above.
The CVIS project is currently not updated to use this file.</p>
<h2 id="inserting-validate-tags">Inserting &lsquo;validate&rsquo; tags</h2>
<p>Adding the CLI parameter NEWKEY=validate will instruct the binary exporter that it shall accept any lines with this keyword in the vspec files.
Before running the command below these lines must be manually edited into the desired nodes.</p>
<pre tabindex="0"><code>(.venv)$ make binary NEWKEY=validate
</code></pre><h2 id="using-the-struct-datatype">Using the struct datatype</h2>
<p>The <a href="https://covesa.github.io/vehicle_signal_specification/rule_set/data_entry/data_types_struct/index.html#general-idea-and-basic-semantics">VSS rule set</a>
defines that struct datatypes shall be defined in a separate type definition tree that the &lsquo;datatype&rsquo; key references, see example below.</p>
<pre tabindex="0"><code>DownloadFile:
  type: actuator
  datatype: Types.Resources.FileDescriptor
#  default: {&#34;name&#34;:&#34;downloadfile.txt&#34;, &#34;hash&#34;:&#34;20e87e71b6948d6e6dd11d776e9be79c374751bb&#34;, &#34;uid&#34;:&#34;1d878212&#34;)
  description: File to be used by the vehicle. Default contains internal filesystem path.
</code></pre><p>The type tree for the example above is found in the resources directory.
If the type tree is stored in the root directory of the VSS tree, then the make file can be called with the command
below to generate binary representations of both trees.</p>
<pre tabindex="0"><code>(.venv)$ make binary TYPETREE=DataTypes.vspec
</code></pre>




<footer class=" footline" >
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/vissr/server/access-control-servers/" title="VISSR Access Control Servers"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/vissr/tools/" title="VISSR Tools" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/vissr/js/clipboard.min.js?1739175074"></script>
    <script src="/vissr/js/perfect-scrollbar.min.js?1739175074"></script>
    <script src="/vissr/js/perfect-scrollbar.jquery.min.js?1739175074"></script>
    <script src="/vissr/js/jquery.sticky.js?1739175074"></script>
    <script src="/vissr/js/featherlight.min.js?1739175074"></script>
    <script src="/vissr/js/highlight.pack.js?1739175074"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/vissr/js/modernizr.custom-3.6.0.js?1739175074"></script>
    <script src="/vissr/js/learn.js?1739175074"></script>
    <script src="/vissr/js/hugo-learn.js?1739175074"></script>
    
        
            <script src="/vissr/mermaid/mermaid.js?1739175074"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>
